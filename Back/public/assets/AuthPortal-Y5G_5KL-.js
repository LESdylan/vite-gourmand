import{r as h,j as e}from"./index-CA9KE_XN.js";import{u as R,a as E,A}from"./useAuth-jaB9SlE_.js";function T({onForgotPassword:m,onRegister:n}){const{login:l,isLoading:i,error:d,clearError:s}=R(),[t,a]=h.useState({email:"",password:""}),[c,o]=h.useState({email:!1,password:!1}),[f,k]=h.useState(!1),S=C=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(C),v={email:c.email&&!S(t.email)?"Veuillez entrer un email valide":"",password:c.password&&t.password.length<8?"Le mot de passe doit contenir au moins 8 caract√®res":""},j=S(t.email)&&t.password.length>=8,p=async C=>{if(C.preventDefault(),s(),!!j)try{await l(t)}catch{}},x=C=>b=>{a(F=>({...F,[C]:b.target.value})),d&&s()},w=C=>()=>{o(b=>({...b,[C]:!0}))};return e.jsxs("form",{className:"auth-form",onSubmit:p,noValidate:!0,children:[d&&e.jsx("div",{className:"auth-alert alert-danger",role:"alert",children:d}),e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"email",className:`form-control ${v.email?"is-invalid":c.email&&t.email?"is-valid":""}`,id:"loginEmail",placeholder:"email@example.com",value:t.email,onChange:x("email"),onBlur:w("email"),disabled:i,autoComplete:"email",required:!0}),e.jsx("label",{htmlFor:"loginEmail",children:"Adresse email"}),v.email&&e.jsx("div",{className:"invalid-feedback",children:v.email})]}),e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:f?"text":"password",className:`form-control ${v.password?"is-invalid":c.password&&t.password?"is-valid":""}`,id:"loginPassword",placeholder:"Mot de passe",value:t.password,onChange:x("password"),onBlur:w("password"),disabled:i,autoComplete:"current-password",required:!0}),e.jsx("label",{htmlFor:"loginPassword",children:"Mot de passe"}),v.password&&e.jsx("div",{className:"invalid-feedback",children:v.password})]}),e.jsxs("div",{className:"form-check mb-3",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:"showPassword",checked:f,onChange:()=>k(!f)}),e.jsx("label",{className:"form-check-label",htmlFor:"showPassword",style:{fontSize:"13px",color:"#666"},children:"Afficher le mot de passe"})]}),e.jsx("div",{className:"forgot-password-link",children:e.jsx("button",{type:"button",onClick:m,disabled:i,children:"Mot de passe oubli√© ?"})}),e.jsx("button",{type:"submit",className:"btn btn-auth-primary",disabled:i||!j,children:i?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Connexion en cours..."]}):"Se connecter"}),e.jsxs("div",{className:"auth-links",children:["Premi√®re visite ?"," ",e.jsx("button",{type:"button",className:"link-btn",onClick:n,disabled:i,children:"Cr√©er un compte"})]})]})}function M({onLogin:m}){const{register:n,isLoading:l,error:i,clearError:d}=R(),[s,t]=h.useState({email:"",password:"",confirmPassword:"",firstName:"",telephoneNumber:"",city:"",country:"France",postalAddress:""}),[a,c]=h.useState({}),[o,f]=h.useState(!1),k=u=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u),S=u=>!u||/^(\+33|0)[1-9](\d{2}){4}$/.test(u.replace(/\s/g,"")),j=(u=>{const P=u.length>=8,g=/[A-Z]/.test(u),N=/[a-z]/.test(u),y=/\d/.test(u);return{hasMinLength:P,hasUpper:g,hasLower:N,hasNumber:y,isValid:P&&g&&N&&y}})(s.password),p={email:a.email&&!k(s.email)?"Veuillez entrer un email valide":"",password:a.password&&!j.isValid?"Le mot de passe ne respecte pas les crit√®res":"",confirmPassword:a.confirmPassword&&s.password!==s.confirmPassword?"Les mots de passe ne correspondent pas":"",firstName:a.firstName&&s.firstName.length<2?"Le pr√©nom doit contenir au moins 2 caract√®res":"",telephoneNumber:a.telephoneNumber&&!S(s.telephoneNumber)?"Num√©ro de t√©l√©phone invalide":""},x=k(s.email)&&j.isValid&&s.password===s.confirmPassword&&s.firstName.length>=2&&S(s.telephoneNumber),w=()=>{const{hasMinLength:u,hasUpper:P,hasLower:g,hasNumber:N}=j,y=[u,P,g,N].filter(Boolean).length;return y<=1?{class:"weak",text:"Faible"}:y===2?{class:"fair",text:"Moyen"}:y===3?{class:"good",text:"Bon"}:{class:"strong",text:"Fort"}},C=async u=>{if(u.preventDefault(),d(),!!x)try{await n({email:s.email,password:s.password,firstName:s.firstName,telephoneNumber:s.telephoneNumber||void 0,city:s.city||void 0,country:s.country||void 0,postalAddress:s.postalAddress||void 0})}catch{}},b=u=>P=>{t(g=>({...g,[u]:P.target.value})),i&&d()},F=u=>()=>{c(P=>({...P,[u]:!0}))},B=w();return e.jsxs("form",{className:"auth-form",onSubmit:C,noValidate:!0,children:[i&&e.jsx("div",{className:"auth-alert alert-danger",role:"alert",children:i}),e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"email",className:`form-control ${p.email?"is-invalid":a.email&&s.email?"is-valid":""}`,id:"regEmail",placeholder:"email@example.com",value:s.email,onChange:b("email"),onBlur:F("email"),disabled:l,autoComplete:"email",required:!0}),e.jsx("label",{htmlFor:"regEmail",children:"Adresse email *"}),p.email&&e.jsx("div",{className:"invalid-feedback",children:p.email})]}),e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control ${p.firstName?"is-invalid":a.firstName&&s.firstName?"is-valid":""}`,id:"regFirstName",placeholder:"Pr√©nom",value:s.firstName,onChange:b("firstName"),onBlur:F("firstName"),disabled:l,autoComplete:"given-name",required:!0}),e.jsx("label",{htmlFor:"regFirstName",children:"Pr√©nom *"}),p.firstName&&e.jsx("div",{className:"invalid-feedback",children:p.firstName})]}),e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:o?"text":"password",className:`form-control ${p.password?"is-invalid":a.password&&j.isValid?"is-valid":""}`,id:"regPassword",placeholder:"Mot de passe",value:s.password,onChange:b("password"),onBlur:F("password"),disabled:l,autoComplete:"new-password",required:!0}),e.jsx("label",{htmlFor:"regPassword",children:"Mot de passe *"}),p.password&&e.jsx("div",{className:"invalid-feedback",children:p.password})]}),s.password&&e.jsxs("div",{className:"password-strength",children:[e.jsx("div",{className:"password-strength-bar",children:e.jsx("div",{className:`bar ${B.class}`})}),e.jsxs("div",{className:"password-strength-text",children:["Force: ",B.text," |",!j.hasMinLength&&" 8 car. min ",!j.hasUpper&&" 1 majuscule ",!j.hasLower&&" 1 minuscule ",!j.hasNumber&&" 1 chiffre"]})]}),e.jsxs("div",{className:"form-floating",style:{marginTop:"16px"},children:[e.jsx("input",{type:o?"text":"password",className:`form-control ${p.confirmPassword?"is-invalid":a.confirmPassword&&s.confirmPassword===s.password&&s.confirmPassword?"is-valid":""}`,id:"regConfirmPassword",placeholder:"Confirmer le mot de passe",value:s.confirmPassword,onChange:b("confirmPassword"),onBlur:F("confirmPassword"),disabled:l,autoComplete:"new-password",required:!0}),e.jsx("label",{htmlFor:"regConfirmPassword",children:"Confirmer le mot de passe *"}),p.confirmPassword&&e.jsx("div",{className:"invalid-feedback",children:p.confirmPassword})]}),e.jsxs("div",{className:"form-check mb-3",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:"showRegPassword",checked:o,onChange:()=>f(!o)}),e.jsx("label",{className:"form-check-label",htmlFor:"showRegPassword",style:{fontSize:"13px",color:"#666"},children:"Afficher les mots de passe"})]}),e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"tel",className:`form-control ${p.telephoneNumber?"is-invalid":a.telephoneNumber&&s.telephoneNumber?"is-valid":""}`,id:"regPhone",placeholder:"06 12 34 56 78",value:s.telephoneNumber,onChange:b("telephoneNumber"),onBlur:F("telephoneNumber"),disabled:l,autoComplete:"tel"}),e.jsx("label",{htmlFor:"regPhone",children:"T√©l√©phone"}),p.telephoneNumber&&e.jsx("div",{className:"invalid-feedback",children:p.telephoneNumber})]}),e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:"form-control",id:"regCity",placeholder:"Ville",value:s.city,onChange:b("city"),disabled:l,autoComplete:"address-level2"}),e.jsx("label",{htmlFor:"regCity",children:"Ville"})]}),e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:"form-control",id:"regPostal",placeholder:"Code postal",value:s.postalAddress,onChange:b("postalAddress"),disabled:l,autoComplete:"postal-code"}),e.jsx("label",{htmlFor:"regPostal",children:"Code postal"})]}),e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:"form-control",id:"regCountry",placeholder:"Pays",value:s.country,onChange:b("country"),disabled:l,autoComplete:"country-name"}),e.jsx("label",{htmlFor:"regCountry",children:"Pays"})]}),e.jsx("button",{type:"submit",className:"btn btn-auth-primary",disabled:l||!x,children:l?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm",role:"status"}),"Inscription en cours..."]}):"Cr√©er mon compte"}),e.jsxs("div",{className:"auth-links",children:["D√©j√† inscrit ?"," ",e.jsx("button",{type:"button",className:"link-btn",onClick:m,disabled:l,children:"Se connecter"})]})]})}function D({onBack:m,onResetSent:n}){const{forgotPassword:l,isLoading:i,error:d,clearError:s}=R(),[t,a]=h.useState(""),[c,o]=h.useState(!1),[f,k]=h.useState(!1),S=x=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(x),v=c&&!S(t)?"Veuillez entrer un email valide":"",j=S(t),p=async x=>{if(x.preventDefault(),s(),!!j)try{await l(t),k(!0),n(t)}catch{}};return f?e.jsxs("div",{className:"auth-form",children:[e.jsxs("div",{className:"auth-alert alert-success",role:"alert",children:[e.jsx("strong",{children:"Email envoy√© !"}),e.jsxs("p",{style:{margin:"8px 0 0"},children:["Un lien de r√©initialisation a √©t√© envoy√© √† ",e.jsx("strong",{children:t}),".",e.jsx("br",{}),"V√©rifiez votre bo√Æte de r√©ception et vos spams."]})]}),e.jsxs("div",{className:"auth-alert alert-info",role:"alert",children:[e.jsx("strong",{children:"Pour les tests :"}),e.jsxs("p",{style:{margin:"8px 0 0"},children:["Le token de reset est affich√© dans les logs du backend.",e.jsx("br",{}),"Copiez-le pour continuer le test de r√©initialisation."]})]}),e.jsx("button",{type:"button",className:"btn btn-auth-primary",onClick:m,style:{marginTop:"16px"},children:"Retour √† la connexion"})]}):e.jsxs("form",{className:"auth-form",onSubmit:p,noValidate:!0,children:[d&&e.jsx("div",{className:"auth-alert alert-danger",role:"alert",children:d}),e.jsx("div",{className:"auth-alert alert-info",role:"alert",children:"Entrez votre adresse email et nous vous enverrons un lien pour r√©initialiser votre mot de passe."}),e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"email",className:`form-control ${v?"is-invalid":c&&t?"is-valid":""}`,id:"forgotEmail",placeholder:"email@example.com",value:t,onChange:x=>{a(x.target.value),d&&s()},onBlur:()=>o(!0),disabled:i,autoComplete:"email",autoFocus:!0,required:!0}),e.jsx("label",{htmlFor:"forgotEmail",children:"Adresse email"}),v&&e.jsx("div",{className:"invalid-feedback",children:v})]}),e.jsx("button",{type:"submit",className:"btn btn-auth-primary",disabled:i||!j,children:i?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm",role:"status"}),"Envoi en cours..."]}):"Envoyer le lien de r√©initialisation"}),e.jsx("div",{className:"auth-links",children:e.jsx("button",{type:"button",className:"link-btn",onClick:m,disabled:i,children:"‚Üê Retour √† la connexion"})})]})}function I({email:m,onSuccess:n,onBack:l}){const{resetPassword:i,isLoading:d,error:s,clearError:t}=R(),[a,c]=h.useState({token:"",newPassword:"",confirmPassword:""}),[o,f]=h.useState({}),[k,S]=h.useState(!1),[v,j]=h.useState(!1),x=(g=>{const N=g.length>=8,y=/[A-Z]/.test(g),V=/[a-z]/.test(g),L=/\d/.test(g);return{hasMinLength:N,hasUpper:y,hasLower:V,hasNumber:L,isValid:N&&y&&V&&L}})(a.newPassword),w={token:o.token&&a.token.length<10?"Token invalide":"",newPassword:o.newPassword&&!x.isValid?"Le mot de passe ne respecte pas les crit√®res":"",confirmPassword:o.confirmPassword&&a.newPassword!==a.confirmPassword?"Les mots de passe ne correspondent pas":""},C=a.token.length>=10&&x.isValid&&a.newPassword===a.confirmPassword,b=()=>{const{hasMinLength:g,hasUpper:N,hasLower:y,hasNumber:V}=x,L=[g,N,y,V].filter(Boolean).length;return L<=1?{class:"weak",text:"Faible"}:L===2?{class:"fair",text:"Moyen"}:L===3?{class:"good",text:"Bon"}:{class:"strong",text:"Fort"}},F=async g=>{if(g.preventDefault(),t(),!!C)try{await i(a.token,a.newPassword),j(!0),setTimeout(()=>{n()},2e3)}catch{}},B=g=>N=>{c(y=>({...y,[g]:N.target.value})),s&&t()},u=g=>()=>{f(N=>({...N,[g]:!0}))},P=b();return v?e.jsx("div",{className:"auth-form",children:e.jsxs("div",{className:"auth-alert alert-success",role:"alert",children:[e.jsx("strong",{children:"Mot de passe r√©initialis√© !"}),e.jsxs("p",{style:{margin:"8px 0 0"},children:["Votre nouveau mot de passe a √©t√© enregistr√©.",e.jsx("br",{}),"Redirection vers la connexion..."]})]})}):e.jsxs("form",{className:"auth-form",onSubmit:F,noValidate:!0,children:[s&&e.jsx("div",{className:"auth-alert alert-danger",role:"alert",children:s}),m&&e.jsxs("div",{className:"auth-alert alert-info",role:"alert",children:["R√©initialisation pour : ",e.jsx("strong",{children:m})]}),e.jsxs("div",{className:"form-floating",children:[e.jsx("textarea",{className:`form-control ${w.token?"is-invalid":o.token&&a.token?"is-valid":""}`,id:"resetToken",placeholder:"Token de r√©initialisation",value:a.token,onChange:B("token"),onBlur:u("token"),disabled:d,style:{height:"80px",resize:"none"},required:!0}),e.jsx("label",{htmlFor:"resetToken",children:"Token de r√©initialisation"}),w.token&&e.jsx("div",{className:"invalid-feedback",children:w.token})]}),e.jsx("div",{className:"auth-alert alert-info",style:{marginTop:"8px"},children:e.jsx("small",{children:"Le token se trouve dans les logs du backend ou dans l'email de r√©initialisation."})}),e.jsxs("div",{className:"form-floating",style:{marginTop:"16px"},children:[e.jsx("input",{type:k?"text":"password",className:`form-control ${w.newPassword?"is-invalid":o.newPassword&&x.isValid?"is-valid":""}`,id:"resetNewPassword",placeholder:"Nouveau mot de passe",value:a.newPassword,onChange:B("newPassword"),onBlur:u("newPassword"),disabled:d,autoComplete:"new-password",required:!0}),e.jsx("label",{htmlFor:"resetNewPassword",children:"Nouveau mot de passe"}),w.newPassword&&e.jsx("div",{className:"invalid-feedback",children:w.newPassword})]}),a.newPassword&&e.jsxs("div",{className:"password-strength",children:[e.jsx("div",{className:"password-strength-bar",children:e.jsx("div",{className:`bar ${P.class}`})}),e.jsxs("div",{className:"password-strength-text",children:["Force: ",P.text," |",!x.hasMinLength&&" 8 car. min ",!x.hasUpper&&" 1 majuscule ",!x.hasLower&&" 1 minuscule ",!x.hasNumber&&" 1 chiffre"]})]}),e.jsxs("div",{className:"form-floating",style:{marginTop:"16px"},children:[e.jsx("input",{type:k?"text":"password",className:`form-control ${w.confirmPassword?"is-invalid":o.confirmPassword&&a.confirmPassword===a.newPassword&&a.confirmPassword?"is-valid":""}`,id:"resetConfirmPassword",placeholder:"Confirmer le mot de passe",value:a.confirmPassword,onChange:B("confirmPassword"),onBlur:u("confirmPassword"),disabled:d,autoComplete:"new-password",required:!0}),e.jsx("label",{htmlFor:"resetConfirmPassword",children:"Confirmer le mot de passe"}),w.confirmPassword&&e.jsx("div",{className:"invalid-feedback",children:w.confirmPassword})]}),e.jsxs("div",{className:"form-check mb-3",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:"showResetPassword",checked:k,onChange:()=>S(!k)}),e.jsx("label",{className:"form-check-label",htmlFor:"showResetPassword",style:{fontSize:"13px",color:"#666"},children:"Afficher les mots de passe"})]}),e.jsx("button",{type:"submit",className:"btn btn-auth-primary",disabled:d||!C,children:d?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm",role:"status"}),"R√©initialisation..."]}):"R√©initialiser mon mot de passe"}),e.jsx("div",{className:"auth-links",children:e.jsx("button",{type:"button",className:"link-btn",onClick:l,disabled:d,children:"‚Üê Retour √† la connexion"})})]})}function z(){const{googleLoginWithCredential:m}=R(),[n,l]=h.useState(!1),[i,d]=h.useState(!1),[s,t]=h.useState(null),a=h.useCallback(async c=>{l(!0),t(null);try{await m(c.credential)}catch(o){const f=o instanceof Error?o.message:"Google login failed";t(f)}finally{l(!1)}},[m]);return h.useEffect(()=>{if(window.google?.accounts?.id){d(!0);return}const c=document.querySelector('script[src="https://accounts.google.com/gsi/client"]');if(c){c.addEventListener("load",()=>d(!0));return}const o=document.createElement("script");return o.src="https://accounts.google.com/gsi/client",o.async=!0,o.defer=!0,o.onload=()=>d(!0),o.onerror=()=>t("Failed to load Google Sign-In"),document.head.appendChild(o),()=>{}},[]),h.useEffect(()=>{!i||!window.google?.accounts?.id||E.getGoogleClientId().then(c=>{if(!c){t("Google Sign-In not configured");return}window.google.accounts.id.initialize({client_id:c,callback:a,auto_select:!1,cancel_on_tap_outside:!0,context:"signin",use_fedcm_for_prompt:!1});const o=document.getElementById("google-signin-button");o&&window.google.accounts.id.renderButton(o,{type:"standard",theme:"outline",size:"large",text:"continue_with",shape:"rectangular",logo_alignment:"left",width:280}),window.google.accounts.id.prompt(f=>{f.isNotDisplayed()&&console.log("One Tap not displayed:",f.getNotDisplayedReason())})}).catch(c=>{console.error("Failed to get Google client ID:",c),t("Google Sign-In configuration error")})},[i,a]),s?e.jsxs("div",{className:"google-login-error",children:[e.jsx("p",{className:"text-danger small",children:s}),e.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>window.location.reload(),children:"R√©essayer"})]}):e.jsxs("div",{className:"google-login-container",children:[n&&e.jsxs("div",{className:"text-center py-2",children:[e.jsx("div",{className:"spinner-border spinner-border-sm text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Connexion en cours..."})}),e.jsx("span",{className:"ms-2 small",children:"Connexion avec Google..."})]}),e.jsx("div",{id:"google-signin-button",style:{display:n?"none":"flex",justifyContent:"center"}}),!i&&!s&&e.jsx("div",{className:"text-center py-2",children:e.jsx("div",{className:"spinner-border spinner-border-sm",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Chargement..."})})})]})}function $({onContinue:m}){const{user:n,logout:l}=R();if(!n)return null;const i=n.email?.includes("@gmail.com")||n.googleId,d=new Date().toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),t=(a=>({admin:{label:"Administrateur",color:"#dc3545",icon:"üëë"},manager:{label:"Manager",color:"#fd7e14",icon:"üìä"},employee:{label:"Employ√©",color:"#0d6efd",icon:"üëî"},client:{label:"Client",color:"#198754",icon:"üçΩÔ∏è"}})[a]||{label:a,color:"#6c757d",icon:"üë§"})(n.role||"client");return e.jsx("div",{style:r.container,children:e.jsxs("div",{style:r.card,children:[e.jsxs("div",{style:r.successBanner,children:[e.jsx("div",{style:r.checkmark,children:"‚úì"}),e.jsx("h1",{style:r.title,children:"Connexion r√©ussie !"})]}),e.jsxs("div",{style:r.profileSection,children:[e.jsxs("div",{style:r.avatarContainer,children:[n.avatar?e.jsx("img",{src:n.avatar,alt:"Avatar",style:r.avatar}):e.jsx("div",{style:r.avatarPlaceholder,children:(n.firstName?.[0]||n.email?.[0]||"?").toUpperCase()}),i&&e.jsx("div",{style:r.googleBadge,children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})})]}),e.jsxs("h2",{style:r.userName,children:["Bienvenue, ",n.firstName||n.email?.split("@")[0]," !"]}),e.jsx("p",{style:r.userEmail,children:n.email}),e.jsxs("div",{style:{...r.roleBadge,backgroundColor:t.color},children:[e.jsx("span",{children:t.icon}),e.jsx("span",{children:t.label})]})]}),e.jsxs("div",{style:r.detailsSection,children:[e.jsx("h3",{style:r.sectionTitle,children:"üìã D√©tails de la session"}),e.jsxs("div",{style:r.detailRow,children:[e.jsx("span",{style:r.detailLabel,children:"ID Utilisateur"}),e.jsxs("span",{style:r.detailValue,children:["#",n.id]})]}),e.jsxs("div",{style:r.detailRow,children:[e.jsx("span",{style:r.detailLabel,children:"M√©thode de connexion"}),e.jsx("span",{style:r.detailValue,children:i?"üîê Google OAuth":"üìß Email/Mot de passe"})]}),e.jsxs("div",{style:r.detailRow,children:[e.jsx("span",{style:r.detailLabel,children:"Date de connexion"}),e.jsx("span",{style:r.detailValue,children:d})]}),e.jsxs("div",{style:r.detailRow,children:[e.jsx("span",{style:r.detailLabel,children:"Statut"}),e.jsx("span",{style:{...r.detailValue,color:"#198754"},children:"‚úÖ Session active"})]})]}),e.jsxs("details",{style:r.tokenSection,children:[e.jsx("summary",{style:r.tokenSummary,children:"üîë Token d'acc√®s (d√©veloppeur)"}),e.jsxs("div",{style:r.tokenContent,children:[e.jsxs("code",{style:r.tokenCode,children:[n.accessToken?.substring(0,50),"..."]}),e.jsx("button",{onClick:()=>navigator.clipboard.writeText(n.accessToken||""),style:r.copyButton,children:"üìã Copier"})]})]}),e.jsxs("div",{style:r.actions,children:[m&&e.jsx("button",{onClick:m,style:r.primaryButton,children:"üè† Continuer vers l'application"}),e.jsx("button",{onClick:l,style:r.secondaryButton,children:"üö™ Se d√©connecter"})]}),e.jsxs("div",{style:r.footer,children:[e.jsx("p",{children:"Vite Gourmand - Restaurant gastronomique"}),e.jsx("p",{style:r.footerSmall,children:"Votre session est s√©curis√©e et chiffr√©e"})]})]})})}const r={container:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f8f9fa",padding:"20px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},card:{backgroundColor:"white",borderRadius:"16px",boxShadow:"0 10px 40px rgba(0,0,0,0.1)",maxWidth:"500px",width:"100%",overflow:"hidden"},successBanner:{background:"linear-gradient(135deg, #198754 0%, #20c997 100%)",padding:"30px",textAlign:"center",color:"white"},checkmark:{width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"30px",margin:"0 auto 15px",animation:"pulse 2s infinite"},title:{margin:0,fontSize:"24px",fontWeight:600},profileSection:{padding:"30px",textAlign:"center",borderBottom:"1px solid #eee"},avatarContainer:{position:"relative",display:"inline-block",marginBottom:"15px"},avatar:{width:"80px",height:"80px",borderRadius:"50%",border:"3px solid #198754"},avatarPlaceholder:{width:"80px",height:"80px",borderRadius:"50%",backgroundColor:"#198754",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"32px",fontWeight:600},googleBadge:{position:"absolute",bottom:"0",right:"0",backgroundColor:"white",borderRadius:"50%",padding:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},userName:{margin:"0 0 5px",fontSize:"22px",color:"#212529"},userEmail:{margin:"0 0 15px",color:"#6c757d",fontSize:"14px"},roleBadge:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"6px 16px",borderRadius:"20px",color:"white",fontSize:"14px",fontWeight:500},detailsSection:{padding:"20px 30px",borderBottom:"1px solid #eee"},sectionTitle:{margin:"0 0 15px",fontSize:"16px",color:"#495057"},detailRow:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px solid #f1f1f1"},detailLabel:{color:"#6c757d",fontSize:"14px"},detailValue:{color:"#212529",fontSize:"14px",fontWeight:500},tokenSection:{padding:"15px 30px",borderBottom:"1px solid #eee",backgroundColor:"#f8f9fa"},tokenSummary:{cursor:"pointer",color:"#6c757d",fontSize:"14px",padding:"5px 0"},tokenContent:{marginTop:"10px",display:"flex",flexDirection:"column",gap:"10px"},tokenCode:{backgroundColor:"#212529",color:"#20c997",padding:"10px",borderRadius:"6px",fontSize:"11px",wordBreak:"break-all"},copyButton:{backgroundColor:"#6c757d",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",fontSize:"12px",alignSelf:"flex-start"},actions:{padding:"20px 30px",display:"flex",flexDirection:"column",gap:"10px"},primaryButton:{backgroundColor:"#198754",color:"white",border:"none",padding:"14px 24px",borderRadius:"8px",fontSize:"16px",fontWeight:500,cursor:"pointer",transition:"background-color 0.2s"},secondaryButton:{backgroundColor:"transparent",color:"#dc3545",border:"1px solid #dc3545",padding:"12px 24px",borderRadius:"8px",fontSize:"14px",cursor:"pointer"},footer:{padding:"20px 30px",textAlign:"center",backgroundColor:"#f8f9fa",color:"#6c757d",fontSize:"13px"},footerSmall:{fontSize:"11px",marginTop:"5px",color:"#adb5bd"}};function G({onBack:m}){const{isAuthenticated:n,user:l,isLoading:i}=R(),[d,s]=h.useState("login"),[t,a]=h.useState(""),c=f=>{a(f),s("reset-password")};if(i&&!l)return e.jsx("div",{className:"auth-portal",children:e.jsxs("div",{className:"auth-card",children:[e.jsx("div",{className:"auth-logo",children:e.jsx("h1",{children:"üçΩÔ∏è Vite Gourmand"})}),e.jsxs("div",{style:{textAlign:"center",padding:"40px"},children:[e.jsx("div",{className:"spinner-border",role:"status",style:{color:"#764ba2"},children:e.jsx("span",{className:"visually-hidden",children:"Chargement..."})}),e.jsx("p",{style:{marginTop:"16px",color:"#666"},children:"V√©rification de la session..."})]})]})});if(n&&l)return e.jsx($,{onContinue:m});const o=()=>{switch(d){case"login":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"auth-title",children:[e.jsx("h2",{children:"Connexion"}),e.jsx("p",{children:"Acc√©dez √† votre espace client"})]}),e.jsx(z,{}),e.jsx("div",{className:"auth-divider",children:e.jsx("span",{children:"ou par email"})}),e.jsx(T,{onForgotPassword:()=>s("forgot-password"),onRegister:()=>s("register")})]});case"register":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"auth-title",children:[e.jsx("h2",{children:"Cr√©er un compte"}),e.jsx("p",{children:"Rejoignez Vite Gourmand"})]}),e.jsx(z,{}),e.jsx("div",{className:"auth-divider",children:e.jsx("span",{children:"ou par email"})}),e.jsx(M,{onLogin:()=>s("login")})]});case"forgot-password":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"auth-title",children:[e.jsx("h2",{children:"Mot de passe oubli√©"}),e.jsx("p",{children:"R√©initialisez votre mot de passe"})]}),e.jsx(D,{onBack:()=>s("login"),onResetSent:c})]});case"reset-password":return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"auth-title",children:[e.jsx("h2",{children:"Nouveau mot de passe"}),e.jsx("p",{children:"Choisissez un nouveau mot de passe s√©curis√©"})]}),e.jsx(I,{email:t,onSuccess:()=>s("login"),onBack:()=>s("login")})]})}};return e.jsxs("div",{className:"auth-portal",children:[m&&e.jsx("button",{className:"back-btn",onClick:m,children:"‚Üê Retour"}),e.jsxs("div",{className:"auth-card",children:[e.jsxs("div",{className:"auth-logo",children:[e.jsx("h1",{children:"üçΩÔ∏è Vite Gourmand"}),e.jsx("p",{className:"subtitle",children:"Traiteur d'exception"})]}),o()]})]})}function _({onBack:m}){return e.jsx(A,{children:e.jsx(G,{onBack:m})})}export{_ as AuthPortal};
